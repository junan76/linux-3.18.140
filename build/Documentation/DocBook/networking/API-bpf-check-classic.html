<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>bpf_check_classic</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="Linux Networking and Network Devices APIs"><link rel="up" href="ch01s03.html" title="Socket Filter"><link rel="prev" href="API-sk-filter.html" title="sk_filter"><link rel="next" href="API-bpf-prog-create.html" title="bpf_prog_create"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center"><span class="phrase">bpf_check_classic</span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="API-sk-filter.html">Prev</a> </td><th width="60%" align="center">Socket Filter</th><td width="20%" align="right"> <a accesskey="n" href="API-bpf-prog-create.html">Next</a></td></tr></table><hr></div><div class="refentry"><a name="API-bpf-check-classic"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>bpf_check_classic — 
     verify socket filter code
 </p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">bpf_check_classic </b>(</code></td><td>const struct sock_filter * <var class="pdparam">filter</var>, </td></tr><tr><td> </td><td>unsigned int <var class="pdparam">flen</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div></div></div><div class="refsect1"><a name="idm7142"></a><h2>Arguments</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="parameter"><code>filter</code></em></span></dt><dd><p>
     filter to verify
    </p></dd><dt><span class="term"><em class="parameter"><code>flen</code></em></span></dt><dd><p>
     length of filter
    </p></dd></dl></div></div><div class="refsect1"><a name="idm7155"></a><h2>Description</h2><p>
   Check the user's filter code. If we let some ugly
   filter code slip through kaboom! The filter must contain
   no references or jumps that are out of range, no illegal
   instructions, and must end with a RET instruction.
   </p><p>

   All jumps are forward as they are not signed.
   </p><p>

   Returns 0 if the rule set is legal or -EINVAL if not.
</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="API-sk-filter.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch01s03.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="API-bpf-prog-create.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"><span class="phrase">sk_filter</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> <span class="phrase">bpf_prog_create</span></td></tr></table></div></body></html>
