<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>drm_gem_mmap_obj</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="Linux DRM Developer's Guide"><link rel="up" href="drm-memory-management.html#idm878" title="GEM Function Reference"><link rel="prev" href="API-drm-gem-object-free.html" title="drm_gem_object_free"><link rel="next" href="API-drm-gem-mmap.html" title="drm_gem_mmap"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center"><span class="phrase">drm_gem_mmap_obj</span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="API-drm-gem-object-free.html">Prev</a> </td><th width="60%" align="center">GEM Function Reference</th><td width="20%" align="right"> <a accesskey="n" href="API-drm-gem-mmap.html">Next</a></td></tr></table><hr></div><div class="refentry"><a name="API-drm-gem-mmap-obj"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>drm_gem_mmap_obj — 
     memory map a GEM object
 </p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">drm_gem_mmap_obj </b>(</code></td><td>struct drm_gem_object * <var class="pdparam">obj</var>, </td></tr><tr><td> </td><td>unsigned long <var class="pdparam">obj_size</var>, </td></tr><tr><td> </td><td>struct vm_area_struct * <var class="pdparam">vma</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div></div></div><div class="refsect1"><a name="idm1361"></a><h2>Arguments</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="parameter"><code>obj</code></em></span></dt><dd><p>
     the GEM object to map
    </p></dd><dt><span class="term"><em class="parameter"><code>obj_size</code></em></span></dt><dd><p>
     the object size to be mapped, in bytes
    </p></dd><dt><span class="term"><em class="parameter"><code>vma</code></em></span></dt><dd><p>
     VMA for the area to be mapped
    </p></dd></dl></div></div><div class="refsect1"><a name="idm1379"></a><h2>Description</h2><p>
   Set up the VMA to prepare mapping of the GEM object using the gem_vm_ops
   provided by the driver. Depending on their requirements, drivers can either
   provide a fault handler in their gem_vm_ops (in which case any accesses to
   the object will be trapped, to perform migration, GTT binding, surface
   register allocation, or performance monitoring), or mmap the buffer memory
   synchronously after calling drm_gem_mmap_obj.
   </p><p>

   This function is mainly intended to implement the DMABUF mmap operation, when
   the GEM object is not looked up based on its fake offset. To implement the
   DRM mmap operation, drivers should use the <code class="function">drm_gem_mmap</code> function.
   </p><p>

   <code class="function">drm_gem_mmap_obj</code> assumes the user is granted access to the buffer while
   <code class="function">drm_gem_mmap</code> prevents unprivileged users from mapping random objects. So
   callers must verify access restrictions before calling this helper.
</p></div><div class="refsect1"><a name="idm1387"></a><h2>NOTE</h2><p>
   This function has to be protected with dev-&gt;struct_mutex
   </p><p>

   Return 0 or success or -EINVAL if the object size is smaller than the VMA
   size, or if no gem_vm_ops are provided.
</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="API-drm-gem-object-free.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="drm-memory-management.html#idm878">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="API-drm-gem-mmap.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"><span class="phrase">drm_gem_object_free</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> <span class="phrase">drm_gem_mmap</span></td></tr></table></div></body></html>
