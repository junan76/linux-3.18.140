<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Chapter 4. drm/i915 Intel GFX Driver</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="Linux DRM Developer's Guide"><link rel="up" href="drmDrivers.html" title="Part II. DRM Drivers"><link rel="prev" href="drmDrivers.html" title="Part II. DRM Drivers"><link rel="next" href="ch04s02.html" title="Memory Management and Command Submission"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 4. drm/i915 Intel GFX Driver</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="drmDrivers.html">Prev</a> </td><th width="60%" align="center">Part II. DRM Drivers</th><td width="20%" align="right"> <a accesskey="n" href="ch04s02.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="drmI915"></a>Chapter 4. drm/i915 Intel GFX Driver</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="drmI915.html#idm16047">Display Hardware Handling</a></span></dt><dd><dl><dt><span class="sect2"><a href="drmI915.html#idm16050">Mode Setting Infrastructure</a></span></dt><dt><span class="sect2"><a href="drmI915.html#idm16053">Plane Configuration</a></span></dt><dt><span class="sect2"><a href="drmI915.html#idm16056">Output Probing</a></span></dt><dt><span class="sect2"><a href="drmI915.html#idm16059">DPIO</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch04s02.html">Memory Management and Command Submission</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch04s02.html#idm16149">Batchbuffer Parsing</a></span></dt><dt><span class="sect2"><a href="ch04s02.html#idm16360">Logical Rings, Logical Ring Contexts and Execlists</a></span></dt></dl></dd></dl></div><p>
      The drm/i915 driver supports all (with the exception of some very early
      models) integrated GFX chipsets with both Intel display and rendering
      blocks. This excludes a set of SoC platforms with an SGX rendering unit,
      those have basic support through the gma500 drm driver.
    </p><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm16047"></a>Display Hardware Handling</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="drmI915.html#idm16050">Mode Setting Infrastructure</a></span></dt><dt><span class="sect2"><a href="drmI915.html#idm16053">Plane Configuration</a></span></dt><dt><span class="sect2"><a href="drmI915.html#idm16056">Output Probing</a></span></dt><dt><span class="sect2"><a href="drmI915.html#idm16059">DPIO</a></span></dt></dl></div><p>
        This section covers everything related to the display hardware including
        the mode setting infrastructure, plane, sprite and cursor handling and
        display, output probing and related topics.
      </p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm16050"></a>Mode Setting Infrastructure</h3></div></div></div><p>
          The i915 driver is thus far the only DRM driver which doesn't use the
          common DRM helper code to implement mode setting sequences. Thus it
          has its own tailor-made infrastructure for executing a display
          configuration change.
        </p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm16053"></a>Plane Configuration</h3></div></div></div><p>
	  This section covers plane configuration and composition with the
	  primary plane, sprites, cursors and overlays. This includes the
	  infrastructure to do atomic vsync'ed updates of all this state and
	  also tightly coupled topics like watermark setup and computation,
	  framebuffer compression and panel self refresh.
        </p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm16056"></a>Output Probing</h3></div></div></div><p>
	  This section covers output probing and related infrastructure like the
	  hotplug interrupt storm detection and mitigation code. Note that the
	  i915 driver still uses most of the common DRM helper code for output
	  probing, so those sections fully apply.
        </p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm16059"></a>DPIO</h3></div></div></div><p>
   </p><p>
   VLV and CHV have slightly peculiar display PHYs for driving DP/HDMI
   ports. DPIO is the name given to such a display PHY. These PHYs
   don't follow the standard programming model using direct MMIO
   registers, and instead their registers must be accessed trough IOSF
   sideband. VLV has one such PHY for driving ports B and C, and CHV
   adds another PHY for driving port D. Each PHY responds to specific
   IOSF-SB port.
   </p><p>
   Each display PHY is made up of one or two channels. Each channel
   houses a common lane part which contains the PLL and other common
   logic. CH0 common lane also contains the IOSF-SB logic for the
   Common Register Interface (CRI) ie. the DPIO registers. CRI clock
   must be running when any DPIO registers are accessed.
   </p><p>
   In addition to having their own registers, the PHYs are also
   controlled through some dedicated signals from the display
   controller. These include PLL reference clock enable, PLL enable,
   and CRI clock selection, for example.
   </p><p>
   Eeach channel also has two splines (also called data lanes), and
   each spline is made up of one Physical Access Coding Sub-Layer
   (PCS) block and two TX lanes. So each channel has two PCS blocks
   and four TX lanes. The TX lanes are used as DP lanes or TMDS
   data/clock pairs depending on the output type.
   </p><p>
   Additionally the PHY also contains an AUX lane with AUX blocks
   for each channel. This is used for DP AUX communication, but
   this fact isn't really relevant for the driver since AUX is
   controlled from the display controller side. No DPIO registers
   need to be accessed during AUX communication,
   </p><p>
   Generally the common lane corresponds to the pipe and
   the spline (PCS/TX) correponds to the port.
   </p><p>
   For dual channel PHY (VLV/CHV):
   </p><p>
   pipe A == CMN/PLL/REF CH0
   </p><p>
   pipe B == CMN/PLL/REF CH1
   </p><p>
   port B == PCS/TX CH0
   </p><p>
   port C == PCS/TX CH1
   </p><p>
   This is especially important when we cross the streams
   ie. drive port B with pipe B, or port C with pipe A.
   </p><p>
   For single channel PHY (CHV):
   </p><p>
   pipe C == CMN/PLL/REF CH0
   </p><p>
   port D == PCS/TX CH0
   </p><p>
   Note: digital port B is DDI0, digital port C is DDI1,
   digital port D is DDI2
</p><div class="table"><a name="dpiox2"></a><p class="title"><b>Table 4.1. Dual channel PHY (VLV/CHV)</b></p><div class="table-contents"><table class="table" summary="Dual channel PHY (VLV/CHV)" border="1"><colgroup><col class="c0"><col class="c1"><col class="c2"><col class="c3"><col class="c4"><col class="c5"><col class="c6"><col class="c7"></colgroup><thead><tr><th colspan="4">CH0</th><th colspan="4">CH1</th></tr></thead><tbody align="center" valign="top"><tr><td colspan="4" align="center" valign="top">CMN/PLL/REF</td><td colspan="4" align="center" valign="top">CMN/PLL/REF</td></tr><tr><td colspan="2" align="center" valign="top">PCS01</td><td colspan="2" align="center" valign="top">PCS23</td><td colspan="2" align="center" valign="top">PCS01</td><td colspan="2" align="center" valign="top">PCS23</td></tr><tr><td align="center" valign="top">TX0</td><td align="center" valign="top">TX1</td><td align="center" valign="top">TX2</td><td align="center" valign="top">TX3</td><td align="center" valign="top">TX0</td><td align="center" valign="top">TX1</td><td align="center" valign="top">TX2</td><td align="center" valign="top">TX3</td></tr><tr><td colspan="4" align="center" valign="top">DDI0</td><td colspan="4" align="center" valign="top">DDI1</td></tr></tbody></table></div></div><br class="table-break"><div class="table"><a name="dpiox1"></a><p class="title"><b>Table 4.2. Single channel PHY (CHV)</b></p><div class="table-contents"><table class="table" summary="Single channel PHY (CHV)" border="1"><colgroup><col class="c0"><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th colspan="4">CH0</th></tr></thead><tbody align="center" valign="top"><tr><td colspan="4" align="center" valign="top">CMN/PLL/REF</td></tr><tr><td colspan="2" align="center" valign="top">PCS01</td><td colspan="2" align="center" valign="top">PCS23</td></tr><tr><td align="center" valign="top">TX0</td><td align="center" valign="top">TX1</td><td align="center" valign="top">TX2</td><td align="center" valign="top">TX3</td></tr><tr><td colspan="4" align="center" valign="top">DDI2</td></tr></tbody></table></div></div><br class="table-break"></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="drmDrivers.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="drmDrivers.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch04s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Part II. DRM Drivers </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Memory Management and Command Submission</td></tr></table></div></body></html>
