<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>struct usb_composite_driver</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="USB Gadget API for Linux"><link rel="up" href="composite.html" title="Composite Device Framework"><link rel="prev" href="API-struct-usb-configuration.html" title="struct usb_configuration"><link rel="next" href="API-module-usb-composite-driver.html" title="module_usb_composite_driver"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center"><span class="phrase">struct usb_composite_driver</span></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="API-struct-usb-configuration.html">Prev</a> </td><th width="60%" align="center">Composite Device Framework</th><td width="20%" align="right"> <a accesskey="n" href="API-module-usb-composite-driver.html">Next</a></td></tr></table><hr></div><div class="refentry"><a name="API-struct-usb-composite-driver"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>struct usb_composite_driver — 
     groups configurations into a gadget
 </p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><pre class="programlisting">
struct usb_composite_driver {
  const char * name;
  const struct usb_device_descriptor * dev;
  struct usb_gadget_strings ** strings;
  enum usb_device_speed max_speed;
  unsigned needs_serial:1;
  int (* bind) (struct usb_composite_dev *cdev);
  int (* unbind) (struct usb_composite_dev *);
  void (* disconnect) (struct usb_composite_dev *);
  void (* suspend) (struct usb_composite_dev *);
  void (* resume) (struct usb_composite_dev *);
  struct usb_gadget_driver gadget_driver;
};  </pre></div><div class="refsect1"><a name="idm2218"></a><h2>Members</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term">name</span></dt><dd><p>
   For diagnostics, identifies the driver.
      </p></dd><dt><span class="term">dev</span></dt><dd><p>
   Template descriptor for the device, including default device
   identifiers.
      </p></dd><dt><span class="term">strings</span></dt><dd><p>
   tables of strings, keyed by identifiers assigned during <em class="parameter"><code>bind</code></em>
   and language IDs provided in control requests. Note: The first entries
   are predefined. The first entry that may be used is
   USB_GADGET_FIRST_AVAIL_IDX
      </p></dd><dt><span class="term">max_speed</span></dt><dd><p>
   Highest speed the driver supports.
      </p></dd><dt><span class="term">needs_serial</span></dt><dd><p>
   set to 1 if the gadget needs userspace to provide
   a serial number.  If one is not provided, warning will be printed.
      </p></dd><dt><span class="term">bind</span></dt><dd><p>
   (REQUIRED) Used to allocate resources that are shared across the
   whole device, such as string IDs, and add its configurations using
   <em class="parameter"><code>usb_add_config</code></em>(). This may fail by returning a negative errno
   value; it should return zero on successful initialization.
      </p></dd><dt><span class="term">unbind</span></dt><dd><p>
   Reverses <em class="parameter"><code>bind</code></em>; called as a side effect of unregistering
   this driver.
      </p></dd><dt><span class="term">disconnect</span></dt><dd><p>
   optional driver disconnect method
      </p></dd><dt><span class="term">suspend</span></dt><dd><p>
   Notifies when the host stops sending USB traffic,
   after function notifications
      </p></dd><dt><span class="term">resume</span></dt><dd><p>
   Notifies configuration when the host restarts USB traffic,
   before function notifications
      </p></dd><dt><span class="term">gadget_driver</span></dt><dd><p>
   Gadget driver controlling this driver
      </p></dd></dl></div></div><div class="refsect1"><a name="idm2268"></a><h2>Description</h2><p>
   Devices default to reporting self powered operation.  Devices which rely
   on bus powered operation should report this in their <em class="parameter"><code>bind</code></em> method.
   </p><p>

   Before returning from <em class="parameter"><code>bind</code></em>, various fields in the template descriptor
   may be overridden.  These include the idVendor/idProduct/bcdDevice values
   normally to bind the appropriate host side driver, and the three strings
   (iManufacturer, iProduct, iSerialNumber) normally used to provide user
   meaningful device identifiers.  (The strings will not be defined unless
   they are defined in <em class="parameter"><code>dev</code></em> and <em class="parameter"><code>strings</code></em>.)  The correct ep0 maxpacket size
   is also reported, as defined by the underlying controller driver.
</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="API-struct-usb-configuration.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="composite.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="API-module-usb-composite-driver.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"><span class="phrase">struct usb_configuration</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> <span class="phrase">module_usb_composite_driver</span></td></tr></table></div></body></html>
